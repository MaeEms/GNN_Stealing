[15:59:09] /opt/dgl/src/runtime/tensordispatch.cc:43: TensorDispatcher: dlopen failed: /home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/dgl/tensoradapter/pytorch/libtensoradapter_pytorch_1.10.2.so: cannot open shared object file: No such file or directory
Using backend: pytorch
 * Serving Flask app 'evaluate_service'
 * Debug mode: off
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:6016
 * Running on http://10.176.22.10:6016
[33mPress CTRL+C to quit[0m
/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/dgl/backend/pytorch/tensor.py:46: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1640811803361/work/torch/csrc/utils/tensor_new.cpp:201.)
  return th.as_tensor(data, dtype=dtype)
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.230.35.93 - - [01/Nov/2023 15:59:27] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
[19:20:35] /opt/dgl/src/runtime/tensordispatch.cc:43: TensorDispatcher: dlopen failed: /home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/dgl/tensoradapter/pytorch/libtensoradapter_pytorch_1.10.2.so: cannot open shared object file: No such file or directory
Using backend: pytorch
 * Serving Flask app 'evaluate_service'
 * Debug mode: off
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:6016
 * Running on http://10.176.22.10:6016
[33mPress CTRL+C to quit[0m
/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/dgl/backend/pytorch/tensor.py:46: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1640811803361/work/torch/csrc/utils/tensor_new.cpp:201.)
  return th.as_tensor(data, dtype=dtype)
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.230.35.93 - - [01/Nov/2023 19:20:59] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.192.21 - - [01/Nov/2023 20:00:51] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.192.21 - - [01/Nov/2023 20:15:35] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.192.21 - - [01/Nov/2023 20:18:42] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
target model:  gin
10.162.192.21 - - [01/Nov/2023 20:49:57] "GET /execute_stealing?target_model=gin&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.192.21 - - [01/Nov/2023 20:55:27] "GET /execute_stealing?target_model=sage&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.192.21 - - [01/Nov/2023 20:57:35] "GET /execute_stealing?target_model=sage&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.218.152 - - [02/Nov/2023 15:58:17] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.143.26 - - [06/Nov/2023 13:52:33] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 14:57:57] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
surrogate model:  gat
[2023-11-06 15:39:17,127] ERROR in app: Exception on /execute_stealing [GET]
Traceback (most recent call last):
  File "/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/flask/app.py", line 869, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/yangchenxi/anaconda3/envs/gnn_model_stealing_backend/lib/python3.9/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/home/data/ycx/GNNStealing_backend/GNNStealing/code/evaluate_service.py", line 257, in execute
    _acc, _predicts,surrogate_class_acc = evaluate_surrogate_model(surrogate_model_name,  surrogate_model, surrogate_model_args, classifier, detached_classifier, test_g)
  File "/home/data/ycx/GNNStealing_backend/GNNStealing/code/evaluate_service.py", line 167, in evaluate_surrogate_model
    acc_surrogate, preds_surrogate, embds_surrogate,class_acc = evaluate_gin_surrogate(surrogate_model,
  File "/home/data/ycx/GNNStealing_backend/GNNStealing/code/src/ginsurrogate.py", line 140, in evaluate_gin_surrogate
    embs = embs.to(device)
AttributeError: 'tuple' object has no attribute 'to'
10.162.137.88 - - [06/Nov/2023 15:39:17] "[35m[1mGET /execute_stealing?target_model=gat&surrogate_model=gin&dataset=citeseer_full HTTP/1.1[0m" 500 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:39:37] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:41:19] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:41:28] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:42:17] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:43:31] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:48:10] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:48:16] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:48:21] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:49:01] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:49:47] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:50:01] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:50:12] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:50:24] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:50:51] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:50:59] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:52:56] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:53:05] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:53:14] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:54:18] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 15:55:30] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:04:56] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:05:19] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:06:48] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.143.26 - - [06/Nov/2023 16:09:33] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:12:20] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:12:57] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:19:28] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:20:36] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:21:39] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:21:55] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.143.26 - - [06/Nov/2023 16:44:01] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:45:15] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
Graph(num_nodes=4230, num_edges=14904,
      ndata_schemes={'features': Scheme(shape=(602,), dtype=torch.float32), 'labels': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={})
10.162.137.88 - - [06/Nov/2023 16:48:21] "GET /execute_stealing?target_model=gat&surrogate_model=sage&dataset=citeseer_full HTTP/1.1" 200 -
